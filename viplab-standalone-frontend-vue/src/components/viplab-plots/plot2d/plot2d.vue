<template>
  <div class="2dplot-component border">
    <div class="plot-div" >
      <Plotly ref="plot" :data="data" :layout="layout" :display-mode-bar="false"></Plotly>
    </div>
    <div>
      <div class="file-controller text-center center-controller">
        <div class="fixed-row-70 display-flex-center">
          <span> {{ currentIndex }}/{{ datasetList.length }} </span>
        </div>
        <b-button-group>
          <b-button btn-variant="white" @click="resetFileIndex">
            <font-awesome-icon icon="fast-backward" />
          </b-button>
          <b-button btn-variant="white" @click="decreaseFileIndex">
            <font-awesome-icon icon="backward" />
          </b-button>
          <b-button btn-variant="white" @click="setEnableAutoPlay">
            <font-awesome-icon v-if="enableAutoPlay" icon="pause" />
            <font-awesome-icon v-else icon="play" />
          </b-button>
          <b-button btn-variant="white" @click="increaseFileIndex">
            <font-awesome-icon icon="forward" />
          </b-button>
          <b-button btn-variant="white" @click="setMaxFileIndex">
            <font-awesome-icon icon="fast-forward" />
          </b-button>
        </b-button-group>
        <div class="fixed-row-70 display-flex-center">
          <b-button btn-variant="white" @click="download()">
            <font-awesome-icon icon="download" />
          </b-button>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import * as LinePlotParser from "./LinePlotParser.js";

import { Plotly } from "vue-plotly";
import plotlyjs from "plotly.js";

export default {
  name: "Plot2d",
  components: {
    Plotly,
  },
  data() {
    return {
      example:
        '{"identifier" : "vipplot.vgf", "value" : "# color 0 200 150\n# symbol none\n# linestyle solid\n# legend explicit euler\n 0.000000 0.000000 0.020000 0.000000\n 0.020000 0.000000 0.040000 0.000279\n 0.040000 0.000279 0.060000 0.000255\n 0.060000 0.000255 0.080000 -0.000630\n 0.080000 -0.000630 0.100000 -0.002227\n 0.100000 -0.002227 0.120000 -0.003534\n 0.120000 -0.003534 0.140000 -0.003324\n 0.140000 -0.003324 0.160000 -0.001153\n 0.160000 -0.001153 0.180000 0.002026\n 0.180000 0.002026 0.200000 0.004216\n 0.200000 0.004216 0.220000 0.003634\n 0.220000 0.003634 0.240000 0.000065\n 0.240000 0.000065 0.260000 -0.004662\n 0.260000 -0.004662 0.280000 -0.007579\n 0.280000 -0.007579 0.300000 -0.006442\n 0.300000 -0.006442 0.320000 -0.001379\n 0.320000 -0.001379 0.340000 0.004847\n 0.340000 0.004847 0.360000 0.008327\n 0.360000 0.008327 0.380000 0.006456\n 0.380000 0.006456 0.400000 -0.000184\n 0.400000 -0.000184 0.420000 -0.007845\n 0.420000 -0.007845 0.440000 -0.011715\n 0.440000 -0.011715 0.460000 -0.008937\n 0.460000 -0.008937 0.480000 -0.000651\n 0.480000 -0.000651 0.500000 0.008366\n 0.500000 0.008366 0.520000 0.012447\n 0.520000 0.012447 0.540000 0.008593\n 0.540000 0.008593 0.560000 -0.001392\n 0.560000 -0.001392 0.580000 -0.011669\n 0.580000 -0.011669 0.600000 -0.015776\n 0.600000 -0.015776 0.620000 -0.010686\n 0.620000 -0.010686 0.640000 0.001034\n 0.640000 0.001034 0.660000 0.012462\n 0.660000 0.012462 0.680000 0.016407\n 0.680000 0.016407 0.700000 0.009929\n 0.700000 0.009929 0.720000 -0.003547\n 0.720000 -0.003547 0.740000 -0.016003\n 0.740000 -0.016003 0.760000 -0.019595\n 0.760000 -0.019595 0.780000 -0.011587\n 0.780000 -0.011587 0.800000 0.003651\n 0.800000 0.003651 0.820000 0.016998\n 0.820000 0.016998 0.840000 0.020043\n 0.840000 0.020043 0.860000 0.010374\n 0.860000 0.010374 0.880000 -0.006613\n 0.880000 -0.006613 0.900000 -0.020704\n 0.900000 -0.020704 0.920000 -0.023007\n 0.920000 -0.023007 0.940000 -0.011557\n 0.940000 -0.011557 0.960000 0.007151\n 0.960000 0.007151 0.980000 0.021825\n 0.980000 0.021825 1.000000 0.023194\n# color 200 150 0\n# symbol none\n# linestyle solid\n# legend heun\n 0.000000 0.000000 0.020000 0.000139\n 0.020000 0.000139 0.040000 0.000267\n 0.040000 0.000267 0.060000 -0.000187\n 0.060000 -0.000187 0.080000 -0.001428\n 0.080000 -0.001428 0.100000 -0.002880\n 0.100000 -0.002880 0.120000 -0.003429\n 0.120000 -0.003429 0.140000 -0.002238\n 0.140000 -0.002238 0.160000 0.000437\n 0.160000 0.000437 0.180000 0.003121\n 0.180000 0.003121 0.200000 0.003925\n 0.200000 0.003925 0.220000 0.001849\n 0.220000 0.001849 0.240000 -0.002298\n 0.240000 -0.002298 0.260000 -0.006120\n 0.260000 -0.006120 0.280000 -0.007010\n 0.280000 -0.007010 0.300000 -0.003910\n 0.300000 -0.003910 0.320000 0.001734\n 0.320000 0.001734 0.340000 0.006587\n 0.340000 0.006587 0.360000 0.007392\n 0.360000 0.007392 0.380000 0.003136\n 0.380000 0.003136 0.400000 -0.004015\n 0.400000 -0.004015 0.420000 -0.009780\n 0.420000 -0.009780 0.440000 -0.010326\n 0.440000 -0.010326 0.460000 -0.004794\n 0.460000 -0.004794 0.480000 0.003858\n 0.480000 0.003858 0.500000 0.010406\n 0.500000 0.010406 0.520000 0.010520\n 0.520000 0.010520 0.540000 0.003600\n 0.540000 0.003600 0.560000 -0.006530\n 0.560000 -0.006530 0.580000 -0.013722\n 0.580000 -0.013722 0.600000 -0.013231\n 0.600000 -0.013231 0.620000 -0.004826\n 0.620000 -0.004826 0.640000 0.006748\n 0.640000 0.006748 0.660000 0.014435\n 0.660000 0.014435 0.680000 0.013168\n 0.680000 0.013168 0.700000 0.003191\n 0.700000 0.003191 0.720000 -0.009775\n 0.720000 -0.009775 0.740000 -0.017799\n 0.740000 -0.017799 0.760000 -0.015591\n 0.760000 -0.015591 0.780000 -0.003968\n 0.780000 -0.003968 0.800000 0.010325\n 0.800000 0.010325 0.820000 0.018521\n 0.820000 0.018521 0.840000 0.015208\n 0.840000 0.015208 0.860000 0.001880\n 0.860000 0.001880 0.880000 -0.013659\n 0.880000 -0.013659 0.900000 -0.021856\n 0.900000 -0.021856 0.920000 -0.017282\n 0.920000 -0.017282 0.940000 -0.002203\n 0.940000 -0.002203 0.960000 0.014488\n 0.960000 0.014488 0.980000 0.022509\n 0.980000 0.022509 1.000000 0.016524\n# color 200 0 150\n# symbol none\n# linestyle solid\n# legend Runge-Kutta 4\n 0.000000 0.000000 0.020000 0.000169\n 0.020000 0.000169 0.040000 0.000357\n 0.040000 0.000357 0.060000 -0.000072\n 0.060000 -0.000072 0.080000 -0.001365\n 0.080000 -0.001365 0.100000 -0.002925\n 0.100000 -0.002925 0.120000 -0.003559\n 0.120000 -0.003559 0.140000 -0.002350\n 0.140000 -0.002350 0.160000 0.000462\n 0.160000 0.000462 0.180000 0.003327\n 0.180000 0.003327 0.200000 0.004232\n 0.200000 0.004232 0.220000 0.002086\n 0.220000 0.002086 0.240000 -0.002286\n 0.240000 -0.002286 0.260000 -0.006357\n 0.260000 -0.006357 0.280000 -0.007353\n 0.280000 -0.007353 0.300000 -0.004122\n 0.300000 -0.004122 0.320000 0.001835\n 0.320000 0.001835 0.340000 0.006999\n 0.340000 0.006999 0.360000 0.007905\n 0.360000 0.007905 0.380000 0.003451\n 0.380000 0.003451 0.400000 -0.004102\n 0.400000 -0.004102 0.420000 -0.010233\n 0.420000 -0.010233 0.440000 -0.010866\n 0.440000 -0.010866 0.460000 -0.005060\n 0.460000 -0.005060 0.480000 0.004082\n 0.480000 0.004082 0.500000 0.011044\n 0.500000 0.011044 0.520000 0.011220\n 0.520000 0.011220 0.540000 0.003945\n 0.540000 0.003945 0.560000 -0.006765\n 0.560000 -0.006765 0.580000 -0.014408\n 0.580000 -0.014408 0.600000 -0.013945\n 0.600000 -0.013945 0.620000 -0.005098\n 0.620000 -0.005098 0.640000 0.007141\n 0.640000 0.007141 0.660000 0.015310\n 0.660000 0.015310 0.680000 0.014028\n 0.680000 0.014028 0.700000 0.003515\n 0.700000 0.003515 0.720000 -0.010199\n 0.720000 -0.010199 0.740000 -0.018726\n 0.740000 -0.018726 0.760000 -0.016447\n 0.760000 -0.016447 0.780000 -0.004193\n 0.780000 -0.004193 0.800000 0.010927\n 0.800000 0.010927 0.820000 0.019638\n 0.820000 0.019638 0.840000 0.016191\n 0.840000 0.016191 0.860000 0.002131\n 0.860000 0.002131 0.880000 -0.014309\n 0.880000 -0.014309 0.900000 -0.023023\n 0.900000 -0.023023 0.920000 -0.018242\n 0.920000 -0.018242 0.940000 -0.002329\n 0.940000 -0.002329 0.960000 0.015332\n 0.960000 0.015332 0.980000 0.023863\n 0.980000 0.023863 1.000000 0.017589\n# color 0 0 255\n# symbol none\n# linestyle solid\n# legend exact\n 0.000000 0.000000 0.020000 0.000169\n 0.020000 0.000169 0.040000 0.000356\n 0.040000 0.000356 0.060000 -0.000073\n 0.060000 -0.000073 0.080000 -0.001366\n 0.080000 -0.001366 0.100000 -0.002926\n 0.100000 -0.002926 0.120000 -0.003559\n 0.120000 -0.003559 0.140000 -0.002350\n 0.140000 -0.002350 0.160000 0.000462\n 0.160000 0.000462 0.180000 0.003327\n 0.180000 0.003327 0.200000 0.004231\n 0.200000 0.004231 0.220000 0.002085\n 0.220000 0.002085 0.240000 -0.002286\n 0.240000 -0.002286 0.260000 -0.006356\n 0.260000 -0.006356 0.280000 -0.007352\n 0.280000 -0.007352 0.300000 -0.004122\n 0.300000 -0.004122 0.320000 0.001835\n 0.320000 0.001835 0.340000 0.006998\n 0.340000 0.006998 0.360000 0.007904\n 0.360000 0.007904 0.380000 0.003450\n 0.380000 0.003450 0.400000 -0.004103\n 0.400000 -0.004103 0.420000 -0.010232\n 0.420000 -0.010232 0.440000 -0.010865\n 0.440000 -0.010865 0.460000 -0.005060\n 0.460000 -0.005060 0.480000 0.004082\n 0.480000 0.004082 0.500000 0.011042\n 0.500000 0.011042 0.520000 0.011218\n 0.520000 0.011218 0.540000 0.003944\n 0.540000 0.003944 0.560000 -0.006764\n 0.560000 -0.006764 0.580000 -0.014407\n 0.580000 -0.014407 0.600000 -0.013944\n 0.600000 -0.013944 0.620000 -0.005097\n 0.620000 -0.005097 0.640000 0.007140\n 0.640000 0.007140 0.660000 0.015308\n 0.660000 0.015308 0.680000 0.014025\n 0.680000 0.014025 0.700000 0.003514\n 0.700000 0.003514 0.720000 -0.010198\n 0.720000 -0.010198 0.740000 -0.018724\n 0.740000 -0.018724 0.760000 -0.016445\n 0.760000 -0.016445 0.780000 -0.004192\n 0.780000 -0.004192 0.800000 0.010925\n 0.800000 0.010925 0.820000 0.019635\n 0.820000 0.019635 0.840000 0.016188\n 0.840000 0.016188 0.860000 0.002130\n 0.860000 0.002130 0.880000 -0.014307\n 0.880000 -0.014307 0.900000 -0.023020\n 0.900000 -0.023020 0.920000 -0.018240\n 0.920000 -0.018240 0.940000 -0.002328\n 0.940000 -0.002328 0.960000 0.015330\n 0.960000 0.015330 0.980000 0.023859\n 0.980000 0.023859 1.000000 0.017586\n# newframe\n# title absolute error\n# x-label x\n# y-label error\n# scale \n# color 0 200 150\n# symbol none\n# linestyle solid\n# legend explicit euler\n 0.000000 0.000000 0.020000 0.000169\n 0.020000 0.000169 0.040000 0.000078\n 0.040000 0.000078 0.060000 0.000328\n 0.060000 0.000328 0.080000 0.000736\n 0.080000 0.000736 0.100000 0.000699\n 0.100000 0.000699 0.120000 0.000025\n 0.120000 0.000025 0.140000 0.000974\n 0.140000 0.000974 0.160000 0.001614\n 0.160000 0.001614 0.180000 0.001301\n 0.180000 0.001301 0.200000 0.000015\n 0.200000 0.000015 0.220000 0.001549\n 0.220000 0.001549 0.240000 0.002351\n 0.240000 0.002351 0.260000 0.001695\n 0.260000 0.001695 0.280000 0.000226\n 0.280000 0.000226 0.300000 0.002320\n 0.300000 0.002320 0.320000 0.003214\n 0.320000 0.003214 0.340000 0.002150\n 0.340000 0.002150 0.360000 0.000423\n 0.360000 0.000423 0.380000 0.003007\n 0.380000 0.003007 0.400000 0.003918\n 0.400000 0.003918 0.420000 0.002387\n 0.420000 0.002387 0.440000 0.000850\n 0.440000 0.000850 0.460000 0.003877\n 0.460000 0.003877 0.480000 0.004732\n 0.480000 0.004732 0.500000 0.002676\n 0.500000 0.002676 0.520000 0.001229\n 0.520000 0.001229 0.540000 0.004648\n 0.540000 0.004648 0.560000 0.005372\n 0.560000 0.005372 0.580000 0.002738\n 0.580000 0.002738 0.600000 0.001833\n 0.600000 0.001833 0.620000 0.005589\n 0.620000 0.005589 0.640000 0.006106\n 0.640000 0.006106 0.660000 0.002846\n 0.660000 0.002846 0.680000 0.002382\n 0.680000 0.002382 0.700000 0.006415\n 0.700000 0.006415 0.720000 0.006651\n 0.720000 0.006651 0.740000 0.002721\n 0.740000 0.002721 0.760000 0.003150\n 0.760000 0.003150 0.780000 0.007394\n 0.780000 0.007394 0.800000 0.007274\n 0.800000 0.007274 0.820000 0.002636\n 0.820000 0.002636 0.840000 0.003855\n 0.840000 0.003855 0.860000 0.008243\n 0.860000 0.008243 0.880000 0.007694\n 0.880000 0.007694 0.900000 0.002316\n 0.900000 0.002316 0.920000 0.004768\n 0.920000 0.004768 0.940000 0.009229\n 0.940000 0.009229 0.960000 0.008180\n 0.960000 0.008180 0.980000 0.002034\n 0.980000 0.002034 1.000000 0.005608\n# color 200 150 0\n# symbol none\n# linestyle solid\n# legend heun\n 0.000000 0.000000 0.020000 0.000030\n 0.020000 0.000030 0.040000 0.000089\n 0.040000 0.000089 0.060000 0.000114\n 0.060000 0.000114 0.080000 0.000063\n 0.080000 0.000063 0.100000 0.000045\n 0.100000 0.000045 0.120000 0.000130\n 0.120000 0.000130 0.140000 0.000111\n 0.140000 0.000111 0.160000 0.000025\n 0.160000 0.000025 0.180000 0.000206\n 0.180000 0.000206 0.200000 0.000306\n 0.200000 0.000306 0.220000 0.000236\n 0.220000 0.000236 0.240000 0.000012\n 0.240000 0.000012 0.260000 0.000236\n 0.260000 0.000236 0.280000 0.000342\n 0.280000 0.000342 0.300000 0.000212\n 0.300000 0.000212 0.320000 0.000101\n 0.320000 0.000101 0.340000 0.000411\n 0.340000 0.000411 0.360000 0.000512\n 0.360000 0.000512 0.380000 0.000314\n 0.380000 0.000314 0.400000 0.000088\n 0.400000 0.000088 0.420000 0.000452\n 0.420000 0.000452 0.440000 0.000539\n 0.440000 0.000539 0.460000 0.000266\n 0.460000 0.000266 0.480000 0.000224\n 0.480000 0.000224 0.500000 0.000636\n 0.500000 0.000636 0.520000 0.000698\n 0.520000 0.000698 0.540000 0.000344\n 0.540000 0.000344 0.560000 0.000234\n 0.560000 0.000234 0.580000 0.000684\n 0.580000 0.000684 0.600000 0.000712\n 0.600000 0.000712 0.620000 0.000271\n 0.620000 0.000271 0.640000 0.000392\n 0.640000 0.000392 0.660000 0.000873\n 0.660000 0.000873 0.680000 0.000857\n 0.680000 0.000857 0.700000 0.000323\n 0.700000 0.000323 0.720000 0.000423\n 0.720000 0.000423 0.740000 0.000925\n 0.740000 0.000925 0.760000 0.000854\n 0.760000 0.000854 0.780000 0.000224\n 0.780000 0.000224 0.800000 0.000600\n 0.800000 0.000600 0.820000 0.001114\n 0.820000 0.001114 0.840000 0.000980\n 0.840000 0.000980 0.860000 0.000250\n 0.860000 0.000250 0.880000 0.000649\n 0.880000 0.000649 0.900000 0.001164\n 0.900000 0.001164 0.920000 0.000958\n 0.920000 0.000958 0.940000 0.000125\n 0.940000 0.000125 0.960000 0.000843\n 0.960000 0.000843 0.980000 0.001350\n 0.980000 0.001350 1.000000 0.001062\n# color 200 0 150\n# symbol none\n# linestyle solid\n# legend Runge-Kutta 4\n 0.000000 0.000000 0.020000 0.000000\n 0.020000 0.000000 0.040000 0.000000\n 0.040000 0.000000 0.060000 0.000001\n 0.060000 0.000001 0.080000 0.000001\n 0.080000 0.000001 0.100000 0.000000\n 0.100000 0.000000 0.120000 0.000000\n 0.120000 0.000000 0.140000 0.000000\n 0.140000 0.000000 0.160000 0.000000\n 0.160000 0.000000 0.180000 0.000001\n 0.180000 0.000001 0.200000 0.000001\n 0.200000 0.000001 0.220000 0.000001\n 0.220000 0.000001 0.240000 0.000000\n 0.240000 0.000000 0.260000 0.000000\n 0.260000 0.000000 0.280000 0.000001\n 0.280000 0.000001 0.300000 0.000001\n 0.300000 0.000001 0.320000 0.000000\n 0.320000 0.000000 0.340000 0.000001\n 0.340000 0.000001 0.360000 0.000002\n 0.360000 0.000002 0.380000 0.000001\n 0.380000 0.000001 0.400000 0.000000\n 0.400000 0.000000 0.420000 0.000001\n 0.420000 0.000001 0.440000 0.000001\n 0.440000 0.000001 0.460000 0.000001\n 0.460000 0.000001 0.480000 0.000001\n 0.480000 0.000001 0.500000 0.000002\n 0.500000 0.000002 0.520000 0.000002\n 0.520000 0.000002 0.540000 0.000001\n 0.540000 0.000001 0.560000 0.000000\n 0.560000 0.000000 0.580000 0.000002\n 0.580000 0.000002 0.600000 0.000002\n 0.600000 0.000002 0.620000 0.000001\n 0.620000 0.000001 0.640000 0.000001\n 0.640000 0.000001 0.660000 0.000002\n 0.660000 0.000002 0.680000 0.000003\n 0.680000 0.000003 0.700000 0.000001\n 0.700000 0.000001 0.720000 0.000001\n 0.720000 0.000001 0.740000 0.000002\n 0.740000 0.000002 0.760000 0.000002\n 0.760000 0.000002 0.780000 0.000001\n 0.780000 0.000001 0.800000 0.000002\n 0.800000 0.000002 0.820000 0.000003\n 0.820000 0.000003 0.840000 0.000003\n 0.840000 0.000003 0.860000 0.000001\n 0.860000 0.000001 0.880000 0.000001\n 0.880000 0.000001 0.900000 0.000003\n 0.900000 0.000003 0.920000 0.000003\n 0.920000 0.000003 0.940000 0.000000\n 0.940000 0.000000 0.960000 0.000002\n 0.960000 0.000002 0.980000 0.000004\n 0.980000 0.000004 1.000000 0.000003\n# newframe\n# title absolute error\n# x-label x\n# y-label error\n# scale \n# color 191 34 34\n# symbol none\n# linestyle solid\n# legend explicit euler\n 0.000000 0.000000 0.020000 0.000169\n 0.020000 0.000169 0.040000 0.000078\n 0.040000 0.000078 0.060000 0.000328\n 0.060000 0.000328 0.080000 0.000736\n 0.080000 0.000736 0.100000 0.000699\n 0.100000 0.000699 0.120000 0.000025\n 0.120000 0.000025 0.140000 0.000974\n 0.140000 0.000974 0.160000 0.001614\n 0.160000 0.001614 0.180000 0.001301\n 0.180000 0.001301 0.200000 0.000015\n 0.200000 0.000015 0.220000 0.001549\n 0.220000 0.001549 0.240000 0.002351\n 0.240000 0.002351 0.260000 0.001695\n 0.260000 0.001695 0.280000 0.000226\n 0.280000 0.000226 0.300000 0.002320\n 0.300000 0.002320 0.320000 0.003214\n 0.320000 0.003214 0.340000 0.002150\n 0.340000 0.002150 0.360000 0.000423\n 0.360000 0.000423 0.380000 0.003007\n 0.380000 0.003007 0.400000 0.003918\n 0.400000 0.003918 0.420000 0.002387\n 0.420000 0.002387 0.440000 0.000850\n 0.440000 0.000850 0.460000 0.003877\n 0.460000 0.003877 0.480000 0.004732\n 0.480000 0.004732 0.500000 0.002676\n 0.500000 0.002676 0.520000 0.001229\n 0.520000 0.001229 0.540000 0.004648\n 0.540000 0.004648 0.560000 0.005372\n 0.560000 0.005372 0.580000 0.002738\n 0.580000 0.002738 0.600000 0.001833\n 0.600000 0.001833 0.620000 0.005589\n 0.620000 0.005589 0.640000 0.006106\n 0.640000 0.006106 0.660000 0.002846\n 0.660000 0.002846 0.680000 0.002382\n 0.680000 0.002382 0.700000 0.006415\n 0.700000 0.006415 0.720000 0.006651\n 0.720000 0.006651 0.740000 0.002721\n 0.740000 0.002721 0.760000 0.003150\n 0.760000 0.003150 0.780000 0.007394\n 0.780000 0.007394 0.800000 0.007274\n 0.800000 0.007274 0.820000 0.002636\n 0.820000 0.002636 0.840000 0.003855\n 0.840000 0.003855 0.860000 0.008243\n 0.860000 0.008243 0.880000 0.007694\n 0.880000 0.007694 0.900000 0.002316\n 0.900000 0.002316 0.920000 0.004768\n 0.920000 0.004768 0.940000 0.009229\n 0.940000 0.009229 0.960000 0.008180\n 0.960000 0.008180 0.980000 0.002034\n 0.980000 0.002034 1.000000 0.005608\n", "MIMEtype" : "application/x-vgf"}',
      data: [],
      layout: {
        title: "My graph",
      },
      datasetList: [],
      currentIndex: 1,
      enableAutoPlay: false,
      // dropdownVModel: "2DGitterplot",
      // xArray: [],
      // yArray: [],
      // minColor: "",
      // maxColor: "",
    };
  },
  watch: {
    enableAutoPlay() {
      this.watchAutoPlayOrPause();
    },
  },
  mounted() {
    // parse file
    var parseTest = new LinePlotParser.LineParser(this.example);
    var testJson = parseTest.parseFileToJson();
    this.datasetList = parseTest.parseValues(testJson);
    // render first plot
    this.createLinePlot(0);
  },
  methods: {
    createLinePlot: function (index) {
      let currentDataset = this.datasetList[index];
      let title = currentDataset.getTitle();
      this.layout = {
        title: title,
        xaxis: {
          title: {
            text: currentDataset.getLabelX(),
          },
        },
        yaxis: {
          title: {
            text: currentDataset.getLabelY(),
          },
        },
      };
      let graphs = currentDataset.getAllGraphs();

      for (let t = 0; t < graphs.length; t++) {
        let currentGraph = graphs[t];
        let lines = currentGraph.getLines();
        let x = [];
        let y = [];
        for (let i = 0; i < lines.length; i++) {
          let line = lines[i];
          x.push(line[0]);
          y.push(line[1]);
          x.push(line[2]);
          y.push(line[3]);
        }

        let trace = {
          x: x,
          y: y,
          name: currentGraph.getLegend(),
          line: {
            color: currentGraph.getColor(),
            dash: currentGraph.getLinestyle(),
          },
          type: "scatter",
        };
        this.data.push(trace);
      }
    },
    resetFileIndex: function () {
      this.currentIndex = 1;
      this.data = [];
      this.createLinePlot(this.currentIndex - 1);
    },
    setMaxFileIndex: function () {
      this.currentIndex = this.datasetList.length;
      this.data = [];
      this.createLinePlot(this.currentIndex - 1);
    },
    increaseFileIndex: function () {
      if (this.currentIndex < this.datasetList.length) {
        this.currentIndex++;
      } else {
        this.currentIndex = this.datasetList.length;
      }
      this.data = [];
      this.createLinePlot(this.currentIndex - 1);
    },
    decreaseFileIndex: function () {
      if (this.currentIndex > 1) {
        this.currentIndex--;
      } else {
        this.currentIndex = 1;
      }
      this.data = [];
      this.createLinePlot(this.currentIndex - 1);
    },
    setEnableAutoPlay: function () {
      this.enableAutoPlay = !this.enableAutoPlay;
      return this.enableAutoPlay;
    },
    watchAutoPlayOrPause: function () {
      if (this.enableAutoPlay) {
        this.interval = setInterval(
          function () {
            this.increaseFileIndex();
          }.bind(this),
          1000
        );
      } else {
        clearInterval(this.interval);
      }
    },
    download: function () {
      let plot = this.$refs.plot;
      return plotlyjs.downloadImage(plot,
          {
            format: 'png', width: 800, height: 600
          }
        )
    },
  },
};
</script>

<!-- Add "scoped" attribute to limit CSS to this component only -->
<style scoped>

.file-controller {
  bottom: 0;
  left: 0;
  right: 0;
  min-height: 66px;
  padding: 12px;
  background: rgba(0, 0, 0, 0.15);
  display: flex;
  align-items: center;
  justify-content: space-between;
  color: #6c757d;
}

.fixed-row-70 {
  flex-basis: 90px;
  flex-grow: 0;
  flex-shrink: 0;
}

div.btn-group {
  margin: 0 auto;
  text-align: center;
  width: 100%;
  display: inline-block;
}

</style>